{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Analisando imagens de containers de forma automatizada com o Clair 1. Crie uma inst\u00e2ncia EC2 (detalhes) 1.1. Entre na p\u00e1gina do AWS EC2 na console da AWS 1.2. Clique em Launch Instance 1.3. No menu lateral, selecione Community AMIs 1.4. Na barra de busca, procure por BlackBelt image Clair 1.5. Ao lado do nome da imagem BlackBelt image Clair , clique em Select 1.6. Clique Next: Configure Instance Details 1.7. No item IAM role selecione o role Clair-CFN-Instance-Role 1.6. Clique em Review and Launch 1.7. Revise os dados da inst\u00e2ncia e clique em Launch 1.8. Nesta parte voc\u00ea ver\u00e1 que para finalizar a cria\u00e7\u00e3o da inst\u00e2ncia, \u00e9 necess\u00e1rio criar ou selecionar uma chave de acesso. 1.8.1. Caso voc\u00ea j\u00e1 possua uma chave a qual tenha acesso, selecione-a para esta etapa. 1.8.2. Caso n\u00e3o tenha, selecione Create a new key pair , d\u00ea um nome para a chave e baixe-a no seu computador. 1.9. Selecione Launch Instances 1.10. Aguarde a cria\u00e7\u00e3o da inst\u00e2ncia 1.11. Ap\u00f3s a cria\u00e7\u00e3o da inst\u00e2ncia, copie o campo \"Public DNS (IPV4)\" da inst\u00e2ncia que voc\u00ea acabou de criar e cole aqui 2. Conectando a inst\u00e2ncia que voc\u00ea acabou de criar (detalhes) 2.1. V\u00e1 at\u00e9 a pagina do AWS EC2 no console da AWS 2.2. Selecione a inst\u00e2ncia criada e clique no bot\u00e3o Connect 2.3. Copie o exemplo de conex\u00e3o que aparece na sua tela e cole aqui 2.4. Abra o seu terminal na pasta onde a chave de acesso est\u00e1 2.5. Cole e rode o comando abaixo no seu terminal <ssh_connect> 3. Configure o AWS CLI na sua inst\u00e2ncia (detalhes) 3.1. Com voc\u00ea logado na inst\u00e2ncia, rode o comando sudo yum update -y 3.2. Aguarde a instala\u00e7\u00e3o dos pacotes mais atuais da AWS 3.10. Execute o comando de configura\u00e7\u00e3o do AWS CLI: aws configure 3.11. Na configura\u00e7\u00e3o de AWS Access key ID deixe vazio pressionando a tecla <enter> 3.12. Depois em AWS Secret Access Key deixe novamente vazio pressionando a tecla <enter> 3.13. Na configura\u00e7\u00e3o de regi\u00e3o da AWS para este laborat\u00f3rio usaremos us-east-1 3.14. No Default output format deixe vazio, somente pressione a tecla enter 3.15. Agora temos o AWS CLI configurado com sucesso 4. Construindo o ambiente com o AWS CloudFormation (detalhes) 4.1. Vamos copiar os templates do CloudFormation do GitHub, para isso cole no seu terminal: git clone https://github.com/aws-samples/aws-codepipeline-docker-vulnerability-scan.git cd aws-codepipeline-docker-vulnerability-scan ``` 4.2. O primeiro CloudFormation que vamos rodar ser\u00e1 o de constru\u00e7\u00e3o do ambiente de redes, como VPCs e subnets. Para isso cole no seu terminal: aws cloudformation create-stack \\ --stack-name coreos-clair-vpc-stack \\ --template-body file://networking-template.yaml 4.3. Verifique como est\u00e1 o est\u00e1gio de cria\u00e7\u00e3o do sua primeira stack no CloudFormation com o comando abaixo: aws cloudformation wait stack-create-complete \\ --stack-name coreos-clair-vpc-stack 4.4. Ap\u00f3s receber o status de conclus\u00e3o do CloudFormation, vamos obter o output da stack: aws cloudformation describe-stacks \\ --stack-name coreos-clair-vpc-stack 4.5. Pegue os dados do output e salve aqui VPC Id: Private-subnet Ids: Public-subnet Ids: Cloud9-environment-name: 5. Construindo a imagem Docker do Clair: (detalhes) 5.1. A primeira coisa que vamos fazer \u00e9 criar um reposit\u00f3rio do ECR. Para isso, cole no seu terminal o comando abaixo: aws ecr create-repository --repository-name coreos-clair 5.2. A execu\u00e7\u00e3o do comando ir\u00e1 gerar um output no terminal. Anote os seguintes dados abaixo: Registry Id: ( registryID ), este \u00e9 o ID de sua conta AWS) Repository ARN: ( repositoryArn ) Repository URI: ( repositoryUri ) 5.3. Inicie o daemon do docker com o comando abaixo sudo systemctl start docker 5.4. Em seguida, construa a imagem do Docker com o comando: docker build -t <ecr-uri> :latest ./coreos-clair 5.5. Por fim, fa\u00e7a o push da imagem para o reposit\u00f3rio criado no ECR: aws ecr get-login --no-include-email | bash docker push <ecr-uri> :latest 6. Fazendo o deploy do Clair usando o AWS CloudFormation: (detalhes) 6.1. Vamos executar outro CloudFormation para fazer o deploy do Clair, execute o seguinte comando no terminal : aws cloudformation create-stack \\ --stack-name coreos-clair-stack \\ --template-body file://coreos-clair/clair-template.yaml \\ --capabilities CAPABILITY_IAM \\ --parameters \\ ParameterKey=\"VpcId\",ParameterValue=\" <vpc_id> \" \\ ParameterKey=\"PublicSubnets\",ParameterValue=\\\" <pub_sub_1> \\\" \\ ParameterKey=\"PrivateSubnets\",ParameterValue=\\\" <priv_sub_1> \\\" \\ ParameterKey=\"ECRRepositoryUri\",ParameterValue=\" <ecr_uri> \" 6.2. Verifique a cria\u00e7\u00e3o do CloudFormation com o comando abaixo aws cloudformation wait stack-create-complete \\ --stack-name coreos-clair-stack 7. Crie um usu\u00e1rio do IAM para login no CodeCommit (detalhes) 7.1. No terminal da instancia, gere uma chave SSH usado o comando ssh-keygen -f /home/ec2-user/.ssh/codecommit_rsa -P \"\" 7.2. Copie o conte\u00fado da chave p\u00fablica SSH com o comando cat /home/ec2-user/.ssh/codecommit_rsa.pub 7.3. Anote a chave publica para uso posterior abaixo codecommit_rsa.pub: 7.4. Entre na p\u00e1gina do Amazon IAM na console da AWS 7.5. Clique em Users no menu lateral 7.6. Clique em Add user 7.7. Em User name preencha com CodeCommit-User , em \"Access type\" selecione Programmatic access e clique em Next: Permissions 7.8. Selecione Attach existing policies directly e filtre por AWSCodeCommitFullAccess 7.9. Selecione a pol\u00edtica AWSCodeCommitFullAccess e clique em Next: Tags 7.10. Clique em Next: Review , verifique as configura\u00e7\u00f5es e clique em Create user 7.11. Clique em Download .csv e grave o arquivo no seu computador e depois clique em Close 7.12. Abra as configura\u00e7\u00f5es do usu\u00e1rio criado, clicando em CodeCommit-User 7.13. Selecione a aba Security credentials e clique em Upload SSH public key 7.14. Preencha o valor da chave com o conte\u00fado gerado anteriormente rsa-pub-key 7.15. Clique em Upload SSH public Key 7.16. Copie o valor do SSH key ID (parecido a APKA4HUQIJ3JABXNTYOY) e anote abaixo SSH key ID: 7.17. echo \"Host git-codecommit.*.amazonaws.com User rsa-pub-key IdentityFile ~/.ssh/codecommit_rsa\" > ~/.ssh/config 7.18. chmod 600 ~/.ssh/config 7.19. Teste a autentica\u00e7\u00e3o usando o comando ssh git-codecommit.us-east-2.amazonaws.com 7.20. Se bem sucedida a configura\u00e7\u00e3o, a sa\u00edda do comando deve iniciar com \"You have successfully authenticated over SSH.\" 8. Fazendo o deploy do site de exemplo com o NGINX: (detalhes) 8.1. Vamos criar um reposit\u00f3rio do CodeCommit para armazenar o website com NGINX, para isso cole os comandos a baixo no seu terminal : 8.1.1. Crie o reposit\u00f3rio: aws codecommit create-repository --repository-name my-nginx-website 8.1.2. Anote a URL para clonar o reposit\u00f3rio por SSH: cloneUrlSsh: 8.1.2. Clone o reposit\u00f3rio usando os comandos abaixo cd ../ git clone <CloneUrlSsh> 8.1.2. Copie o site NGINX do reposit\u00f3rio: cp -R aws-codepipeline-docker-vulnerability-scan/nginx-website/* my-nginx-website/ 8.1.3. Fa\u00e7a os comentarios da sua altera\u00e7\u00e3o, e envie-lo: cd my-nginx-website/ git add * git commit -m \"Initial commit\" git push 8.2. Agora, criaremos um reposit\u00f3rio para hospedar a imagem do site NGINX: 8.2.1. Crie o reposit\u00f3rio: aws ecr create-repository --repository-name nginx-website 8.2.2. A execu\u00e7\u00e3o do comando ir\u00e1 gerar um output no terminal. Anote os seguintes dados abaixo: Registry Id: ( registryID ), este \u00e9 o ID de sua conta AWS) Repository ARN: ( repositoryArn ) Repository URI: ( repositoryUri ) 8.2.2. Construindo a imagem do docker docker build -f Dockerfile-amznlinux -t <ecr_uri> :latest . 8.2.3. Envie a imagem do docker para o reposit\u00f3rio: docker push <ecr_uri> /nginx-website:latest 8.3. Ent\u00e3o, vamos fazer o deploy do site NGINX usando o AWS CloudFormation . Coloque no seu terminal os comandos a seguir: 8.3.1. Volte uma pasta na sua instancia: cd ../aws-codepipeline-docker-vulnerability-scan/ 8.3.2. Cole no seu terminal todas as linhas abaixo, para a cria\u00e7\u00e3o dos recursos via CloudFormation : aws cloudformation create-stack \\ --stack-name nginx-website-stack \\ --template-body file://nginx-website/nginx-website-template.yaml \\ --capabilities CAPABILITY_IAM \\ --parameters \\ ParameterKey=\"VpcId\",ParameterValue=\" <vpc_id> \" \\ ParameterKey=\"PublicSubnets\",ParameterValue=\\\" <pub_sub_1> \\\" \\ ParameterKey=\"PrivateSubnets\",ParameterValue=\\\" <priv_sub_1> \\\" \\ ParameterKey=\"ECRRepositoryUri\",ParameterValue=\" <ecr_uri> \" 8.3.3. Verifique se a constru\u00e7\u00e3o do CloudFormation foi feita com sucesso, com o comando abaixo: aws cloudformation wait stack-create-complete \\ --stack-name nginx-website-stack 8.3.4. Pegue os outputs do CloudFormation que acabamos de criar colocando os seguintes comandos no seu terminal: aws cloudformation describe-stacks \\ --stack-name nginx-website-stack \\ --query 'Stacks[].Outputs[]' 8.3.5. Cole aqui os dois outputs do CloudFormation que acabamos de criar: A url do seu loadbalancer : O nome do seu service do ECS : 9. Criando o pipeline (detalhes) 9.1. Vamos Criar um CloudFormation para criar o pipeline com o Clair. O template a seguir cria um projeto no CodBuild, um pipeline no ColdPipeline, ua regra no Amazon CloudWatch Events e as permiss\u00f5es necess\u00e1rias pelo IAM. 9.2. Cole no seu terminal os comandos abaixo para a cria\u00e7\u00e3o da stack no CloudFormation aws cloudformation create-stack \\ --stack-name nginx-website-codepipeline-stack \\ --template-body file://clair-codepipeline-template.yaml \\ --capabilities CAPABILITY_IAM \\ --disable-rollback \\ --parameters \\ ParameterKey=\"EcrRepositoryArn\",ParameterValue=\" <ecr_arn> \" \\ ParameterKey=\"EcrRepositoryUri\",ParameterValue=\" <ecr_uri> \" \\ ParameterKey=\"ClairAlbDnsName\",ParameterValue=\" <nginx_url> \" \\ ParameterKey=\"EcsServiceName\",ParameterValue=\" <ecs_name> \" \\ ParameterKey=\"NginxWebsiteCodeCommitRepoArn\",ParameterValue=\" <codecommit_repo_arn> \" 10. Verificando os resultados no CloudWatch Logs (detalhes) 10.1. Acesse o CloudWatch Logs no console da AWS 10.2. Entre na sess\u00e3o de Logs , no menu a esquerda 10.3. Selecione o /aws/codebuild/nginx-codeBuild-project , para que voc\u00ea possa fazer a analise 10.4. L\u00e1 fica salvo todos os logs dentro das pastas, l\u00e1 se pode verificar todas as vunerabilidades que foram encontradas pelo Clair.","title":"Home"},{"location":"#analisando-imagens-de-containers-de-forma-automatizada-com-o-clair","text":"","title":"Analisando imagens de containers de forma automatizada com o Clair"},{"location":"#1-crie-uma-instancia-ec2","text":"(detalhes) 1.1. Entre na p\u00e1gina do AWS EC2 na console da AWS 1.2. Clique em Launch Instance 1.3. No menu lateral, selecione Community AMIs 1.4. Na barra de busca, procure por BlackBelt image Clair 1.5. Ao lado do nome da imagem BlackBelt image Clair , clique em Select 1.6. Clique Next: Configure Instance Details 1.7. No item IAM role selecione o role Clair-CFN-Instance-Role 1.6. Clique em Review and Launch 1.7. Revise os dados da inst\u00e2ncia e clique em Launch 1.8. Nesta parte voc\u00ea ver\u00e1 que para finalizar a cria\u00e7\u00e3o da inst\u00e2ncia, \u00e9 necess\u00e1rio criar ou selecionar uma chave de acesso. 1.8.1. Caso voc\u00ea j\u00e1 possua uma chave a qual tenha acesso, selecione-a para esta etapa. 1.8.2. Caso n\u00e3o tenha, selecione Create a new key pair , d\u00ea um nome para a chave e baixe-a no seu computador. 1.9. Selecione Launch Instances 1.10. Aguarde a cria\u00e7\u00e3o da inst\u00e2ncia 1.11. Ap\u00f3s a cria\u00e7\u00e3o da inst\u00e2ncia, copie o campo \"Public DNS (IPV4)\" da inst\u00e2ncia que voc\u00ea acabou de criar e cole aqui","title":"1. Crie uma inst\u00e2ncia EC2"},{"location":"#2-conectando-a-instancia-que-voce-acabou-de-criar","text":"(detalhes) 2.1. V\u00e1 at\u00e9 a pagina do AWS EC2 no console da AWS 2.2. Selecione a inst\u00e2ncia criada e clique no bot\u00e3o Connect 2.3. Copie o exemplo de conex\u00e3o que aparece na sua tela e cole aqui 2.4. Abra o seu terminal na pasta onde a chave de acesso est\u00e1 2.5. Cole e rode o comando abaixo no seu terminal <ssh_connect>","title":"2. Conectando a inst\u00e2ncia que voc\u00ea acabou de criar"},{"location":"#3-configure-o-aws-cli-na-sua-instancia","text":"(detalhes) 3.1. Com voc\u00ea logado na inst\u00e2ncia, rode o comando sudo yum update -y 3.2. Aguarde a instala\u00e7\u00e3o dos pacotes mais atuais da AWS 3.10. Execute o comando de configura\u00e7\u00e3o do AWS CLI: aws configure 3.11. Na configura\u00e7\u00e3o de AWS Access key ID deixe vazio pressionando a tecla <enter> 3.12. Depois em AWS Secret Access Key deixe novamente vazio pressionando a tecla <enter> 3.13. Na configura\u00e7\u00e3o de regi\u00e3o da AWS para este laborat\u00f3rio usaremos us-east-1 3.14. No Default output format deixe vazio, somente pressione a tecla enter 3.15. Agora temos o AWS CLI configurado com sucesso","title":"3. Configure o AWS CLI na sua inst\u00e2ncia"},{"location":"#4-construindo-o-ambiente-com-o-aws-cloudformation","text":"(detalhes) 4.1. Vamos copiar os templates do CloudFormation do GitHub, para isso cole no seu terminal: git clone https://github.com/aws-samples/aws-codepipeline-docker-vulnerability-scan.git cd aws-codepipeline-docker-vulnerability-scan ``` 4.2. O primeiro CloudFormation que vamos rodar ser\u00e1 o de constru\u00e7\u00e3o do ambiente de redes, como VPCs e subnets. Para isso cole no seu terminal: aws cloudformation create-stack \\ --stack-name coreos-clair-vpc-stack \\ --template-body file://networking-template.yaml 4.3. Verifique como est\u00e1 o est\u00e1gio de cria\u00e7\u00e3o do sua primeira stack no CloudFormation com o comando abaixo: aws cloudformation wait stack-create-complete \\ --stack-name coreos-clair-vpc-stack 4.4. Ap\u00f3s receber o status de conclus\u00e3o do CloudFormation, vamos obter o output da stack: aws cloudformation describe-stacks \\ --stack-name coreos-clair-vpc-stack 4.5. Pegue os dados do output e salve aqui VPC Id: Private-subnet Ids: Public-subnet Ids: Cloud9-environment-name:","title":"4. Construindo o ambiente com o AWS CloudFormation"},{"location":"#5-construindo-a-imagem-docker-do-clair","text":"(detalhes) 5.1. A primeira coisa que vamos fazer \u00e9 criar um reposit\u00f3rio do ECR. Para isso, cole no seu terminal o comando abaixo: aws ecr create-repository --repository-name coreos-clair 5.2. A execu\u00e7\u00e3o do comando ir\u00e1 gerar um output no terminal. Anote os seguintes dados abaixo: Registry Id: ( registryID ), este \u00e9 o ID de sua conta AWS) Repository ARN: ( repositoryArn ) Repository URI: ( repositoryUri ) 5.3. Inicie o daemon do docker com o comando abaixo sudo systemctl start docker 5.4. Em seguida, construa a imagem do Docker com o comando: docker build -t <ecr-uri> :latest ./coreos-clair 5.5. Por fim, fa\u00e7a o push da imagem para o reposit\u00f3rio criado no ECR: aws ecr get-login --no-include-email | bash docker push <ecr-uri> :latest","title":"5. Construindo a imagem Docker do Clair:"},{"location":"#6-fazendo-o-deploy-do-clair-usando-o-aws-cloudformation","text":"(detalhes) 6.1. Vamos executar outro CloudFormation para fazer o deploy do Clair, execute o seguinte comando no terminal : aws cloudformation create-stack \\ --stack-name coreos-clair-stack \\ --template-body file://coreos-clair/clair-template.yaml \\ --capabilities CAPABILITY_IAM \\ --parameters \\ ParameterKey=\"VpcId\",ParameterValue=\" <vpc_id> \" \\ ParameterKey=\"PublicSubnets\",ParameterValue=\\\" <pub_sub_1> \\\" \\ ParameterKey=\"PrivateSubnets\",ParameterValue=\\\" <priv_sub_1> \\\" \\ ParameterKey=\"ECRRepositoryUri\",ParameterValue=\" <ecr_uri> \" 6.2. Verifique a cria\u00e7\u00e3o do CloudFormation com o comando abaixo aws cloudformation wait stack-create-complete \\ --stack-name coreos-clair-stack","title":"6. Fazendo o deploy do Clair usando o AWS CloudFormation:"},{"location":"#7-crie-um-usuario-do-iam-para-login-no-codecommit","text":"(detalhes) 7.1. No terminal da instancia, gere uma chave SSH usado o comando ssh-keygen -f /home/ec2-user/.ssh/codecommit_rsa -P \"\" 7.2. Copie o conte\u00fado da chave p\u00fablica SSH com o comando cat /home/ec2-user/.ssh/codecommit_rsa.pub 7.3. Anote a chave publica para uso posterior abaixo codecommit_rsa.pub: 7.4. Entre na p\u00e1gina do Amazon IAM na console da AWS 7.5. Clique em Users no menu lateral 7.6. Clique em Add user 7.7. Em User name preencha com CodeCommit-User , em \"Access type\" selecione Programmatic access e clique em Next: Permissions 7.8. Selecione Attach existing policies directly e filtre por AWSCodeCommitFullAccess 7.9. Selecione a pol\u00edtica AWSCodeCommitFullAccess e clique em Next: Tags 7.10. Clique em Next: Review , verifique as configura\u00e7\u00f5es e clique em Create user 7.11. Clique em Download .csv e grave o arquivo no seu computador e depois clique em Close 7.12. Abra as configura\u00e7\u00f5es do usu\u00e1rio criado, clicando em CodeCommit-User 7.13. Selecione a aba Security credentials e clique em Upload SSH public key 7.14. Preencha o valor da chave com o conte\u00fado gerado anteriormente rsa-pub-key 7.15. Clique em Upload SSH public Key 7.16. Copie o valor do SSH key ID (parecido a APKA4HUQIJ3JABXNTYOY) e anote abaixo SSH key ID: 7.17. echo \"Host git-codecommit.*.amazonaws.com User rsa-pub-key IdentityFile ~/.ssh/codecommit_rsa\" > ~/.ssh/config 7.18. chmod 600 ~/.ssh/config 7.19. Teste a autentica\u00e7\u00e3o usando o comando ssh git-codecommit.us-east-2.amazonaws.com 7.20. Se bem sucedida a configura\u00e7\u00e3o, a sa\u00edda do comando deve iniciar com \"You have successfully authenticated over SSH.\"","title":"7. Crie um usu\u00e1rio do IAM para login no CodeCommit"},{"location":"#8-fazendo-o-deploy-do-site-de-exemplo-com-o-nginx","text":"(detalhes) 8.1. Vamos criar um reposit\u00f3rio do CodeCommit para armazenar o website com NGINX, para isso cole os comandos a baixo no seu terminal : 8.1.1. Crie o reposit\u00f3rio: aws codecommit create-repository --repository-name my-nginx-website 8.1.2. Anote a URL para clonar o reposit\u00f3rio por SSH: cloneUrlSsh: 8.1.2. Clone o reposit\u00f3rio usando os comandos abaixo cd ../ git clone <CloneUrlSsh> 8.1.2. Copie o site NGINX do reposit\u00f3rio: cp -R aws-codepipeline-docker-vulnerability-scan/nginx-website/* my-nginx-website/ 8.1.3. Fa\u00e7a os comentarios da sua altera\u00e7\u00e3o, e envie-lo: cd my-nginx-website/ git add * git commit -m \"Initial commit\" git push 8.2. Agora, criaremos um reposit\u00f3rio para hospedar a imagem do site NGINX: 8.2.1. Crie o reposit\u00f3rio: aws ecr create-repository --repository-name nginx-website 8.2.2. A execu\u00e7\u00e3o do comando ir\u00e1 gerar um output no terminal. Anote os seguintes dados abaixo: Registry Id: ( registryID ), este \u00e9 o ID de sua conta AWS) Repository ARN: ( repositoryArn ) Repository URI: ( repositoryUri ) 8.2.2. Construindo a imagem do docker docker build -f Dockerfile-amznlinux -t <ecr_uri> :latest . 8.2.3. Envie a imagem do docker para o reposit\u00f3rio: docker push <ecr_uri> /nginx-website:latest 8.3. Ent\u00e3o, vamos fazer o deploy do site NGINX usando o AWS CloudFormation . Coloque no seu terminal os comandos a seguir: 8.3.1. Volte uma pasta na sua instancia: cd ../aws-codepipeline-docker-vulnerability-scan/ 8.3.2. Cole no seu terminal todas as linhas abaixo, para a cria\u00e7\u00e3o dos recursos via CloudFormation : aws cloudformation create-stack \\ --stack-name nginx-website-stack \\ --template-body file://nginx-website/nginx-website-template.yaml \\ --capabilities CAPABILITY_IAM \\ --parameters \\ ParameterKey=\"VpcId\",ParameterValue=\" <vpc_id> \" \\ ParameterKey=\"PublicSubnets\",ParameterValue=\\\" <pub_sub_1> \\\" \\ ParameterKey=\"PrivateSubnets\",ParameterValue=\\\" <priv_sub_1> \\\" \\ ParameterKey=\"ECRRepositoryUri\",ParameterValue=\" <ecr_uri> \" 8.3.3. Verifique se a constru\u00e7\u00e3o do CloudFormation foi feita com sucesso, com o comando abaixo: aws cloudformation wait stack-create-complete \\ --stack-name nginx-website-stack 8.3.4. Pegue os outputs do CloudFormation que acabamos de criar colocando os seguintes comandos no seu terminal: aws cloudformation describe-stacks \\ --stack-name nginx-website-stack \\ --query 'Stacks[].Outputs[]' 8.3.5. Cole aqui os dois outputs do CloudFormation que acabamos de criar: A url do seu loadbalancer : O nome do seu service do ECS :","title":"8. Fazendo o deploy do site de exemplo com o NGINX:"},{"location":"#9-criando-o-pipeline","text":"(detalhes) 9.1. Vamos Criar um CloudFormation para criar o pipeline com o Clair. O template a seguir cria um projeto no CodBuild, um pipeline no ColdPipeline, ua regra no Amazon CloudWatch Events e as permiss\u00f5es necess\u00e1rias pelo IAM. 9.2. Cole no seu terminal os comandos abaixo para a cria\u00e7\u00e3o da stack no CloudFormation aws cloudformation create-stack \\ --stack-name nginx-website-codepipeline-stack \\ --template-body file://clair-codepipeline-template.yaml \\ --capabilities CAPABILITY_IAM \\ --disable-rollback \\ --parameters \\ ParameterKey=\"EcrRepositoryArn\",ParameterValue=\" <ecr_arn> \" \\ ParameterKey=\"EcrRepositoryUri\",ParameterValue=\" <ecr_uri> \" \\ ParameterKey=\"ClairAlbDnsName\",ParameterValue=\" <nginx_url> \" \\ ParameterKey=\"EcsServiceName\",ParameterValue=\" <ecs_name> \" \\ ParameterKey=\"NginxWebsiteCodeCommitRepoArn\",ParameterValue=\" <codecommit_repo_arn> \"","title":"9. Criando o pipeline"},{"location":"#10-verificando-os-resultados-no-cloudwatch-logs","text":"(detalhes) 10.1. Acesse o CloudWatch Logs no console da AWS 10.2. Entre na sess\u00e3o de Logs , no menu a esquerda 10.3. Selecione o /aws/codebuild/nginx-codeBuild-project , para que voc\u00ea possa fazer a analise 10.4. L\u00e1 fica salvo todos os logs dentro das pastas, l\u00e1 se pode verificar todas as vunerabilidades que foram encontradas pelo Clair.","title":"10. Verificando os resultados no CloudWatch Logs"}]}